<html>
<head>
  <!-- Google Tag Manager -->
  <!-- <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KZVTZX6N');</script> -->
  <!-- End Google Tag Manager -->

  <title>Basic WebViewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
</head>

<!-- Import WebViewer as a script tag -->
<script src='./lib/webviewer.min.js'></script>

<body>
  <!-- Google Tag Manager (noscript) -->
  <!-- <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KZVTZX6N"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> -->
  <!-- End Google Tag Manager (noscript) -->

  <div id='viewer' style='width: 1024px; height: 600px; margin: 0 auto;'></div>

  <script>
    WebViewer({
      path: './lib', // path to the Apryse 'lib' folder on your server
      initialDoc: 'https://d2hhfzo2srpqqw.cloudfront.net/dev-grupoa/dev-edtech/36780/d504f637-aa00-451c-a4d1-37ea7ded4c18.xlsx',
      // initialDoc: '/path/to/my/file.pdf', // You can also use documents on your server
    }, document.getElementById('viewer'))
    .then(instance => {
      const { documentViewer, annotationManager } = instance.Core;

      documentViewer.addEventListener('documentLoaded', async () => {
        const xfdfString = `<?xml version="1.0" encoding="UTF-8" ?><xfdf xmlns="http://ns.adobe.com/xfdf/" xml:space="preserve"><pdf-info xmlns="http://www.pdftron.com/pdfinfo" version="2" import-version="4" /><fields /><annots><square page="0" rect="500.12,211.69,525.27,231.4" color="#E44234" flags="print" name="3f46fa43-d402-08fc-2802-1842dd7290ee" title="teacher-plataforma-nome-social" subject="Retângulo" date="D:20240520105006-03'00'" creationdate="D:20240520105006-03'00'" dashes=""/><square page="0" rect="131.630,478.980,226.850,529.390" color="#E44234" flags="print" name="f16bc11b-7c50-408b-e4f6-cbf1ddcc1151" title="teacher-plataforma-nome-social" subject="Retângulo" date="D:20240521145448-03'00'" creationdate="D:20240521145447-03'00'" dashes=""/><square page="0" rect="335.480,419.690,444.590,522.290" color="#E44234" flags="print" name="e52b539d-3164-00c9-f97c-8acc29f030bc" title="teacher-plataforma-nome-social" subject="Retângulo" date="D:20240521150333-03'00'" creationdate="D:20240521150333-03'00'" dashes=""/><square page="3" rect="496.050,194.200,521.870,211.180" color="#E44234" flags="print" name="5db3767a-550c-4808-5227-0a18239df162" title="teacher-plataforma-nome-social" subject="Retângulo" date="D:20240520105039-03'00'" creationdate="D:20240520105039-03'00'"/><square page="3" rect="67.130,42.610,274.490,169.670" color="#E44234" flags="print" name="23b457aa-0fc0-c128-e5de-0dc6561cd4a9" title="teacher-plataforma-nome-social" subject="Retângulo" date="D:20240521150213-03'00'" creationdate="D:20240521150211-03'00'"/></annots><pages><defmtx matrix="1,0,0,-1,0,563" /><pgmtx matrix="1,0,0,-1,0,318" page="1" /><pgmtx matrix="1,0,0,-1,0,318" page="2" /><pgmtx matrix="1,0,0,-1,0,413" page="3" /><pgmtx matrix="1,0,0,-1,0,5730" page="4" /><pgmtx matrix="1,0,0,-1,0,2983" page="5" /><pgmtx matrix="1,0,0,-1,0,1392" page="6" /><pgmtx matrix="1,0,0,-1,0,738" page="7" /></pages></xfdf>`
        await annotationManager.importAnnotations(xfdfString);
      });

      instance.UI.setHeaderItems(header => {
        header.push({
          type: 'actionButton',
          img: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>',
          onClick: async () => {
            console.log('start export', new Date());
            const annotations = await annotationManager.exportAnnotations()
            console.log('end export', new Date());
            console.log(annotations);
          }
        });
      });
    });
  </script>
</body>
</html>
